<!DOCTYPE html>
<html lang="en">
<head>
  <title>Happy Birthday</title>
  <meta charset="UTF-8" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
  <link rel="stylesheet" type="text/css" href="stylesheet.css">
  <link rel="stylesheet" type="text/css" href="loading.css">
  <style>
    /* Puzzle styles */
    .game-container {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin: 20px;
      flex-wrap: wrap;
    }
    .photo img {
      width: 180px;
      border-radius: 10px;
      border: 2px solid #ccc;
    }
    .dropzone {
      width: 200px;
      height: 250px;
      border: 2px dashed #aaa;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      color: #666;
    }
    .dropzone.over {
      border-color: #3b82f6;
      background: #eef6ff;
    }
    .success {
      text-align: center;
      font-size: 1.5em;
      margin-top: 20px;
      color: green;
    }
    .hidden {
      display: none;
    }
  </style>
</head>

<body>
  <div class="loading"></div>
  <audio class="song" controls loop>
    <source src="hbd.mp3"></source>
    Your browser isn't invited for super fun audio time.
  </audio>

  <!-- Balloons, cake, messages etc (your original code stays same) -->
  <div class="container">
    <!-- ... your lights, balloons, cake etc ... -->
    <div class="row message">
      <div class="col-md-12">
        <p>Today is...</p>
        <p> the most special day of my life </p>
        <p> because itâ€™s your birthday. </p>
        <p> Iâ€™m forever grateful for your existence </p>
        <p> and the love youâ€™ve given me. </p>
        <p> I promise to always be hereâ€” </p>
        <p> loving you, caring for you, and</p>
        <p> supporting you endlessly. </p>
        <p> My love for you is eternal. </p>
      </div>
    </div>

    <div class="navbar navbar-fixed-bottom">
      <div class="row">
        <div class="col-md-6 text-center col-md-offset-3">
          <button class="btn btn-primary" id="turn_on">Turn On Lights</button>
          <button class="btn btn-primary" id="play">Play Music</button>
          <button class="btn btn-primary" id="bannar_coming">Let's Decorate</button>
          <button class="btn btn-primary" id="balloons_flying">Fly With Balloons</button>
          <button class="btn btn-primary" id="cake_fadein">Most Delicious Cake Ever</button>
          <button class="btn btn-primary" id="light_candle"> Light Candle</button>
          <button class="btn btn-primary" id="wish_message">Happy Birthday</button>
          <button class="btn btn-primary" id="story">A mesage for you</button>
        </div>
      </div>
    </div>
  </div>

  <!-- ðŸŽ® Puzzle Game (hidden initially) -->
  <div id="puzzleGame" class="hidden">
    <h1 class="text-center">Arrange My Life in Order ðŸŽ‰</h1>
    <p class="text-center">Drag the photos into the correct order: Baby â†’ Student â†’ Suit</p>

    <div class="game-container" id="photos">
      <div class="photo" draggable="true" id="baby"><img src="photo1.jpg"></div>
      <div class="photo" draggable="true" id="student"><img src="photo2.jpg"></div>
      <div class="photo" draggable="true" id="suit"><img src="photo3.jpg"></div>
    </div>

    <div class="game-container">
      <div class="dropzone" data-id="baby">Drop Baby</div>
      <div class="dropzone" data-id="student">Drop Student</div>
      <div class="dropzone" data-id="suit">Drop Suit</div>
    </div>

    <div class="success hidden" id="successMsg">
      ðŸŽŠ Great! You arranged my life correctly! ðŸŽŠ
    </div>
  </div>

  <!-- Scripts -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
  <script src="effect.js"></script>

  <script>
    // Show puzzle 2s after message finishes
    $('#story').click(function() {
      $(this).fadeOut('slow');
      $('.cake').fadeOut('fast').promise().done(function(){
        $('.message').fadeIn('slow').delay(3000).promise().done(function(){
          setTimeout(() => {
            $('#puzzleGame').fadeIn('slow').removeClass('hidden');
          }, 2000); // 2 sec delay
        });
      });

      var i;
      function msgLoop(i) {
        $("p:nth-child(" + i + ")").fadeOut('slow').delay(800).promise().done(function() {
          i = i + 1;
          $("p:nth-child(" + i + ")").fadeIn('slow').delay(1000);
          if (i == 50) {
            $("p:nth-child(49)").fadeOut('slow').promise().done(function () {
              $('.cake').fadeIn('fast');
            });
          } else {
            msgLoop(i);
          }
        });
      }
      msgLoop(0);
    });

    // Puzzle Drag/Drop Logic
    const photos = document.querySelectorAll(".photo");
    const dropzones = document.querySelectorAll(".dropzone");
    const successMsg = document.getElementById("successMsg");

    photos.forEach(photo => {
      photo.addEventListener("dragstart", e => {
        e.dataTransfer.setData("id", e.target.id);
      });
    });

    dropzones.forEach(zone => {
      zone.addEventListener("dragover", e => {
        e.preventDefault();
        zone.classList.add("over");
      });
      zone.addEventListener("dragleave", () => {
        zone.classList.remove("over");
      });
      zone.addEventListener("drop", e => {
        e.preventDefault();
        const photoId = e.dataTransfer.getData("id");
        const dragged = document.getElementById(photoId);
        if (zone.dataset.id === photoId) {
          zone.appendChild(dragged);
          zone.classList.remove("over");
          checkWin();
        } else {
          alert("Oops! Wrong place ðŸ˜…");
        }
      });
    });

    function checkWin() {
      const correct = [...dropzones].every(zone => {
        return zone.querySelector(`#${zone.dataset.id}`);
      });
      if (correct) {
        successMsg.classList.remove("hidden");
      }
    }
  </script>
</body>
</html>
